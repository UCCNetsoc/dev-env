<source>
    @type forward
    port 24224
    bind 0.0.0.0
</source>

<filter netsocadmin>
    @type grep
    <exclude>
        key log
        pattern /.* \[INFO\] gunicorn.(access|error)/
    </exclude>
</filter>

<filter netsocadmin>
    @type parser
    key_name log
    <parse>
        @type regexp
        expression /(?<@timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}) \[(?<level>[A-Z]{4,})\] (?<module>\S+) +- (?<log>.+)/
        time_key @timestamp
        time_format %Y-%m-%dT%H:%M:%S
    </parse>
</filter>

<match netsocadmin>
    @type elasticsearch
    host elasticsearch
    port 9200
    logstash_format true
    logstash_prefix fluentd-${tag}
    logstash_dateformat %Y:%m
    include_tag_key true
    flush_interval 5s
</match>