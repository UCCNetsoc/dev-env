FROM golang:1.14-alpine

ENV REPO=https://github.com/pterodactyl/wings.git
RUN git clone --depth=1 ${REPO} /go/wings

WORKDIR /go/wings/
RUN apk add --no-cache upx \
    && go build -ldflags="-s -w" \
    && upx --brute wings

FROM alpine:latest
COPY --from=0 /go/wings/wings /usr/bin/
CMD ["wings","--config", "/var/lib/pterodactyl/config.yml"]
